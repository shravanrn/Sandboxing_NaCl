cd "$(dirname "$0")"

currDir=$(dirname "$0")
sandboxDir=$(realpath "$currDir/../../../../../")

g++ -c -O0 -m32 -mno-align-double -I"$sandboxDir" -o dyn_ldr_benchmark.o dyn_ldr_benchmark.cpp
g++ -m32 -mno-align-double -o dyn_ldr_benchmark_32 -Wl,-rpath="$sandboxDir/native_client/scons-out/opt-linux-x86-32/lib" -L"$sandboxDir/native_client/scons-out/opt-linux-x86-32/lib" dyn_ldr_benchmark.o -ldyn_ldr -lsel -lnacl_error_code -lenv_cleanser -lnrd_xfer -lnacl_perf_counter -lnacl_base -limc -lnacl_fault_inject -lnacl_interval -lplatform_qual_lib -lvalidators -ldfa_validate_caller_x86_32 -lcpu_features -lvalidation_cache -lplatform -lgio -lnccopy_x86_32 -lrt -lpthread

g++ -c -O0 -m64 -mno-align-double -I"$sandboxDir" -o dyn_ldr_benchmark.o dyn_ldr_benchmark.cpp
g++ -m64 -mno-align-double -o dyn_ldr_benchmark_64 -Wl,-rpath="$sandboxDir/native_client/scons-out/opt-linux-x86-64/lib" -L"$sandboxDir/native_client/scons-out/opt-linux-x86-64/lib" dyn_ldr_benchmark.o -ldyn_ldr -lsel -lnacl_error_code -lenv_cleanser -lnrd_xfer -lnacl_perf_counter -lnacl_base -limc -lnacl_fault_inject -lnacl_interval -lplatform_qual_lib -lvalidators -ldfa_validate_caller_x86_64 -lcpu_features -lvalidation_cache -lplatform -lgio -lnccopy_x86_64 -lrt -lpthread